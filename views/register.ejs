<div class="auth-shell">
  <section class="card auth-card">
    <h1>Inscription</h1>

    <% if (error) { %>
      <div class="alert alert-error">
        <%= error %>
      </div>
      <% } %>

        <form method="post" action="/register" class="form">
          <label>Prénom
            <input type="text" name="first_name" placeholder="David" required />
          </label>

          <label>Nom
            <input type="text" name="last_name" placeholder="COHEN" />
          </label>

          <label>Nom affiché
            <input type="text" name="display_name" placeholder="David COHEN" required />
          </label>

          <label>Email
            <input type="email" name="email" placeholder="david@hebrewlearn.fr" required />
          </label>

          <label>Niveau
            <select name="level" required>
              <option value="Debutant">Débutant</option>
              <option value="Intermediaire">Intermédiaire</option>
              <option value="Avance">Avancé</option>
              <option value="Expert">Expert</option>
            </select>
          </label>

          <label>Mot de passe
            <input type="password" name="password" required />
          </label>

          <button type="submit">Créer mon compte</button>
        </form>

        <script>
          (() => {
            const first = document.querySelector('input[name="first_name"]');
            const last = document.querySelector('input[name="last_name"]');
            const display = document.querySelector('input[name="display_name"]');
            if (!first || !display) return;
            let userEdited = false;
            let lastAuto = '';
            display.addEventListener('input', () => {
              userEdited = display.value !== lastAuto;
            });
            const sync = () => {
              const parts = [first.value.trim(), last ? last.value.trim() : ''].filter(Boolean);
              const val = parts.join(' ').trim();
              if (!userEdited || val === '') {
                display.value = val;
                lastAuto = val;
                userEdited = false;
              }
            };
            first.addEventListener('input', sync);
            if (last) last.addEventListener('input', sync);
          })();
        </script>

        <p>Déjà inscrit ? <a href="/login">Connexion</a></p>
  </section>
</div>
