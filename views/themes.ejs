<section>
  <div class="list-header">
    <h1>ThÃ¨mes</h1>
    <div class="mode-switch">
      <button type="button" class="tab-btn active" data-target="tab-actif">Actifs</button>
      <button type="button" class="tab-btn" data-target="tab-inactif">Inactifs</button>
    </div>
    <a class="link" href="/train/setup">Lancer une session</a>
  </div>

  <div id="tab-actif" class="tab-panel">
    <div class="card">
      <h3 style="margin-top:0;">ProposÃ©s</h3>
      <% if (!proposedThemes || proposedThemes.length === 0) { %>
        <p>Pas encore de thÃ¨mes publics.</p>
      <% } else { %>
        <ul class="list">
          <% proposedThemes.forEach(t => { %>
            <li>
              <div>
                <strong><%= t.name %></strong>
                <% if (currentUser && currentUser.role === 'admin') { %>
                  <form action="/themes/<%= t.id %>/toggle" method="post" style="display:inline;margin-left:0.35rem;">
                    <button class="link" type="submit" title="DÃ©sactiver">ğŸ‘</button>
                  </form>
                <% } %>
                <% if (t.parent_name) { %><div style="color:#94a3b8;font-size:0.9rem;">Parent : <%= t.parent_name %></div><% } %>
              </div>
              <a class="link" href="/themes/<%= t.id %>">Voir</a>
            </li>
          <% }) %>
        </ul>
      <% } %>
    </div>

    <div class="card" style="margin-top:1rem;">
      <div class="list-header" style="margin-bottom:0.5rem;">
        <h3 style="margin:0;">Mes thÃ¨mes</h3>
        <a class="btn" href="/my/themes/new">Ajouter</a>
      </div>
      <% if (!personalThemes || personalThemes.length === 0) { %>
        <p>Pas encore de thÃ¨mes personnels.</p>
      <% } else { %>
        <ul class="list">
          <% personalThemes.forEach(t => { %>
            <li>
              <div>
                <strong><%= t.name %></strong>
                <form action="/themes/<%= t.id %>/toggle" method="post" style="display:inline;margin-left:0.35rem;">
                  <button class="link" type="submit" title="DÃ©sactiver">ğŸ‘</button>
                </form>
                <% if (t.parent_name) { %><div style="color:#94a3b8;font-size:0.9rem;">Parent : <%= t.parent_name %></div><% } %>
              </div>
              <div class="mode-switch">
                <a class="link" href="/themes/<%= t.id %>">Voir</a>
                <a class="link" href="/my/themes/<%= t.id %>/edit">Modifier</a>
                <form action="/my/themes/<%= t.id %>?_method=DELETE" method="post" style="display:inline;">
                  <button type="submit" onclick="return confirm('Supprimer ce thÃ¨me ?');">Supprimer</button>
                </form>
              </div>
            </li>
          <% }) %>
        </ul>
      <% } %>
    </div>
  </div>

  <div id="tab-inactif" class="tab-panel" style="display:none;">
    <div class="card">
      <h3 style="margin-top:0;">ProposÃ©s inactifs</h3>
      <% if (!inactiveProposed || inactiveProposed.length === 0) { %>
        <p>Aucun thÃ¨me inactif.</p>
      <% } else { %>
        <ul class="list">
          <% inactiveProposed.forEach(t => { %>
            <li>
              <div><strong><%= t.name %></strong></div>
              <div class="mode-switch">
                <% if (currentUser && currentUser.role === 'admin') { %>
                  <form action="/themes/<%= t.id %>/toggle" method="post" style="display:inline;">
                    <button class="link" type="submit" title="Activer">ğŸ™ˆ</button>
                  </form>
                <% } %>
                <span title="Inactif">ğŸ”’</span>
              </div>
            </li>
          <% }) %>
        </ul>
      <% } %>
    </div>

    <div class="card" style="margin-top:1rem;">
      <h3 style="margin-top:0;">Mes thÃ¨mes inactifs</h3>
      <% if (!inactivePersonal || inactivePersonal.length === 0) { %>
        <p>Pas de thÃ¨mes personnels inactifs.</p>
      <% } else { %>
        <ul class="list">
          <% inactivePersonal.forEach(t => { %>
            <li>
              <div><strong><%= t.name %></strong></div>
              <div class="mode-switch">
                <form action="/themes/<%= t.id %>/toggle" method="post" style="display:inline;">
                  <button class="link" type="submit" title="Activer">ğŸ™ˆ</button>
                </form>
                <span title="Inactif">ğŸ”’</span>
              </div>
            </li>
          <% }) %>
        </ul>
      <% } %>
    </div>
  </div>
</section>

<script>
  (() => {
    const tabs = document.querySelectorAll('.tab-btn');
    const panels = document.querySelectorAll('.tab-panel');
    tabs.forEach(btn => {
      btn.addEventListener('click', () => {
        tabs.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const target = btn.dataset.target;
        panels.forEach(p => {
          p.style.display = p.id === target ? 'block' : 'none';
        });
      });
    });
  })();
</script>
